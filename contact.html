<!DOCTYPE html>
<html lang="pl" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SuperObozy CRM — kontakt</title>
    <link rel="stylesheet" href="./styles.css" />

    <style>
      /* FORCE LIGHT THEME */
      body{ background:#f6f7fb !important; color:#0f172a !important; }
      .card{ background:#ffffff !important; color:#0f172a !important; border:1px solid #e5e7eb !important; }
      .page{ background:#fff !important; border-color:#e5e7eb !important; }
      input,select,textarea{
        background:#fff !important; color:#0f172a !important;
        border:1px solid #d0d7de !important;
      }
      .camp{ background:#f1f5f9 !important; color:#334155 !important; border-color:#e5e7eb !important; }
      .camp:has(input:checked){ background:#eaf6ff !important; color:#064e80 !important; border-color:#cae9ff !important; }
      .btn{ color:#fff !important; }
      .primary{ background:#0ea5e9 !important; }
      .wa{ background:#2b9348 !important; }
      .ghost{ background:#fff !important; color:#475569 !important; border:1px solid #e5e7eb !important; }
      .small,.help{ color:#64748b !important; }
    </style>
  </head>

  <body>
    <div class="shell">
      <div class="header" style="display:flex;justify-content:space-between;align-items:center;">
        <div class="brand">🌲 SuperObozy — <span style="color:#0ea5e9">CRM</span></div>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="themeToggle" class="ghost btn" type="button">☀️ Jasny</button>
        </div>
      </div>

      <div class="page">
        <div class="card">
          <h3>🧑‍💼 Nowy kontakt</h3>
          <p class="small">Zapisz kontakt, follow-up i notatki. Po dodaniu możesz od razu otworzyć WhatsApp.</p>

          <div class="grid2">
            <div class="field">
              <label>Źródło</label>
              <select id="source"><option>Telefon</option><option>Mail</option><option>Formularz www</option><option>FB/IG</option><option>Inne</option></select>
            </div>
            <div class="field">
              <label>Opiekun</label>
              <input id="owner" placeholder="np. Piotr" />
            </div>

            <div class="field">
              <label>Klub / Szkoła</label>
              <input id="club" placeholder="np. UKS Orlik" />
            </div>
            <div class="field">
              <label>Osoba</label>
              <input id="person" placeholder="np. Anna Kowalska" />
            </div>

            <div class="field">
              <label>Telefon</label>
              <input id="phone" placeholder="+48 600 700 800" />
            </div>
            <div class="field">
              <label>E-mail</label>
              <input id="email" placeholder="kontakt@klub.pl" />
            </div>

            <div class="field">
              <label>Dyscyplina</label>
              <input id="sport" placeholder="np. piłka nożna / judo" />
            </div>
            <div class="field">
              <label>Uczestników</label>
              <input id="participants" type="number" min="1" step="1" />
            </div>

            <div class="field">
              <label>Zaplecze</label>
              <input id="facilities" placeholder="np. hala, boisko" />
            </div>
            <div class="field">
              <label>Termin (okno)</label>
              <input id="term_window" placeholder="np. 15–28 lipca" />
            </div>

            <div class="field grid1" style="grid-column:1 / -1">
              <label>Lokalizacja preferowana</label>
              <input id="location_pref" placeholder="np. zachodniopomorskie / morze" />
            </div>
          </div>

          <div class="section-title">Zainteresowany campami:</div>
          <div class="campbar">
            <label class="camp"><input type="checkbox" id="camp_jastrowie"> Jastrowie</label>
            <label class="camp"><input type="checkbox" id="camp_lipka"> Lipka</label>
            <label class="camp"><input type="checkbox" id="camp_dabki"> Dąbki</label>
            <label class="camp"><input type="checkbox" id="camp_pobierowo"> Pobierowo</label>
            <label class="camp"><input type="checkbox" id="camp_rewal"> Rewal</label>
          </div>

          <div class="grid2" style="margin-top:12px;">
            <div class="field">
              <label>Notatki</label>
              <textarea id="notes" placeholder="Ustalenia z rozmowy..."></textarea>
            </div>
            <div class="field">
              <label>Follow-up</label>
              <select id="followUpDays">
                <option value="0">— brak —</option>
                <option value="2">za 2 dni</option>
                <option value="3" selected>za 3 dni</option>
                <option value="5">za 5 dni</option>
                <option value="7">za 7 dni</option>
              </select>
              <div class="help">Po zapisaniu możesz od razu otworzyć WhatsApp.</div>
            </div>
          </div>

          <div class="bar">
            <button class="btn primary" id="btnAdd">💾 Zapisz nowy kontakt</button>
            <button class="btn wa" id="btnAddAndWA">💾🟢 Zapisz i otwórz WhatsApp</button>
          </div>
        </div>

        <!-- LISTA LEADÓW -->
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3>📋 Leady</h3>
            <button class="btn ghost" id="btnReload" style="color:#334155;">🔄 Odśwież listę</button>
          </div>
          <table class="table">
            <thead>
              <tr><th>ID</th><th>Klub</th><th>Osoba</th><th>Tel</th><th>Status</th><th>Następny kontakt</th></tr>
            </thead>
            <tbody id="leadBody"></tbody>
          </table>
          <div class="small">Kliknij w wiersz, aby otworzyć „Kartę klienta”.</div>
        </div>
      </div>
    </div>

    <!-- Importy -->
    <script src="./config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="./app.js" defer></script>

    <!-- Przełącznik motywu -->
    <script>
      (function(){
        const root=document.documentElement;
        const saved=localStorage.getItem('crm-theme');
        if(saved) root.setAttribute('data-theme', saved);
        const btn=document.getElementById('themeToggle');
        if(btn){
          const label=()=>btn.textContent = root.getAttribute('data-theme')==='dark' ? '🌙 Ciemny' : '☀️ Jasny';
          label();
          btn.addEventListener('click',()=>{
            const next = root.getAttribute('data-theme')==='dark' ? 'light' : 'dark';
            root.setAttribute('data-theme', next);
            localStorage.setItem('crm-theme', next);
            label();
          });
        }
      })();
    </script>
  </body>
</html>
